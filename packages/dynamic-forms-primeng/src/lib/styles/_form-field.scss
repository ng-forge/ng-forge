/**
 * PrimeNG Form Field Styling
 *
 * Customizable styles for PrimeNG form field components.
 * Override CSS variables to customize:
 *
 * --df-field-gap: gap between label, input, and hint (default: 0.5rem)
 * --df-label-font-weight: label font weight (default: 500)
 * --df-label-color: label text color (default: inherit)
 * --df-hint-color: hint text color (default: --p-text-muted-color)
 * --df-hint-font-size: hint text size (default: 0.875rem)
 * --df-error-color: error text color (default: --p-red-500)
 * --df-error-font-size: error text size (default: 0.875rem)
 */

// ============================================
// CSS Variables (PrimeNG-themed defaults)
// ============================================

:host {
  --df-field-gap: 0.5rem;
  --df-label-font-weight: 500;
  --df-label-color: inherit;
  --df-hint-color: var(--p-text-muted-color, #6c757d);
  --df-hint-font-size: 0.875rem;
  --df-error-color: var(--p-red-500, #ef4444);
  --df-error-font-size: 0.875rem;
}

// ============================================
// Field Layout
// ============================================

.df-prime-field {
  display: flex;
  flex-direction: column;
  gap: var(--df-field-gap);
  width: 100%;
}

.df-prime-label {
  font-weight: var(--df-label-font-weight);
  color: var(--df-label-color);
}

.df-prime-hint {
  color: var(--df-hint-color);
  font-size: var(--df-hint-font-size);
}

.p-error {
  color: var(--df-error-color);
  font-size: var(--df-error-font-size);
  display: block;
  margin-top: 0.25rem;
}

// ============================================
// Hidden State
// ============================================

:host([hidden]) {
  display: none !important;
}

// ============================================
// Error State Override
// ============================================

/**
 * Angular Signal Forms auto-propagates form state (invalid, required, etc.)
 * to component inputs via `updateInteropControl`. This causes PrimeNG components
 * to receive `invalid=true` immediately when validation fails, BEFORE the field
 * is touched.
 *
 * We cannot override this via [invalid] binding - Angular explicitly prevents
 * binding to auto-propagated inputs when using [formField].
 *
 * This CSS override hides invalid styling until the field is touched (.ng-touched),
 * which aligns with standard UX: show errors only after user interaction.
 *
 * ::ng-deep is required because PrimeNG elements don't receive Angular's _ngcontent
 * attribute, so view-encapsulated styles won't match. The selector is scoped to
 * :host to prevent style leakage.
 */
:host(:not(.ng-touched)) ::ng-deep {
  // Reset border colors for invalid inputs that haven't been touched
  .p-inputtext.p-invalid,
  .p-select.p-invalid,
  .p-multiselect.p-invalid,
  .p-datepicker.p-invalid,
  .p-checkbox.p-invalid,
  .p-toggleswitch.p-invalid,
  .p-slider.p-invalid {
    border-color: var(--p-inputtext-border-color, var(--p-form-field-border-color));
  }

  // Reset placeholder color for select components
  .p-select.p-invalid .p-select-label.p-placeholder,
  .p-multiselect.p-invalid .p-multiselect-label.p-placeholder {
    color: var(--p-select-placeholder-color, var(--p-text-muted-color));
  }
}
