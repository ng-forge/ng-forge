/**
 * PrimeNG Form Field Styling
 *
 * Customizable styles for form field layouts.
 * Override CSS variables to customize:
 *
 * --df-prime-field-gap: gap between label, input, and hint (default: 0.5rem)
 * --df-prime-label-font-weight: label font weight (default: 500)
 * --df-prime-hint-color: hint text color (default: --p-text-muted-color or #6c757d)
 * --df-prime-hint-font-size: hint text size (default: 0.875rem)
 * --df-prime-error-color: error message text color (default: --p-red-500 or #ef4444)
 * --df-prime-error-font-size: error message text size (default: 0.875rem)
 */

:host {
  --df-prime-field-gap: 0.5rem;
  --df-prime-label-font-weight: 500;
  --df-prime-hint-color: var(--p-text-muted-color, #6c757d);
  --df-prime-hint-font-size: 0.875rem;
  --df-prime-error-color: var(--p-red-500, #ef4444);
  --df-prime-error-font-size: 0.875rem;
}

.df-prime-field {
  display: flex;
  flex-direction: column;
  gap: var(--df-prime-field-gap);
  width: 100%;
}

.df-prime-label {
  font-weight: var(--df-prime-label-font-weight);
}

.df-prime-hint {
  color: var(--df-prime-hint-color);
  font-size: var(--df-prime-hint-font-size);
}

.p-error {
  color: var(--df-prime-error-color);
  font-size: var(--df-prime-error-font-size);
  display: block;
  margin-top: 0.25rem;
}

/**
 * Override PrimeNG invalid styling when field is not touched.
 *
 * PrimeNG components inject NgControl and use its `invalid` property to add
 * `p-invalid` class. Angular Signal Forms' InteropNgControl returns the raw
 * invalid state without considering touched. We override this with CSS to
 * only show invalid styling when the field has been touched.
 *
 * Components must add [class.df-touched]="field()().touched()" to their host.
 */
:host:not(.df-touched) {
  // Reset input border color to default when not touched
  ::ng-deep {
    .p-inputtext.p-invalid,
    .p-select.p-invalid,
    .p-multiselect.p-invalid,
    .p-datepicker.p-invalid,
    .p-slider.p-invalid,
    .p-toggleswitch.p-invalid,
    .p-checkbox.p-invalid,
    .p-radiobutton.p-invalid,
    .p-textarea.p-invalid {
      border-color: var(--p-form-field-border-color, var(--p-surface-300, #dee2e6)) !important;
    }

    // Also handle focused state for untouched invalid fields
    .p-inputtext.p-invalid:focus,
    .p-select.p-invalid.p-focus,
    .p-multiselect.p-invalid.p-focus,
    .p-datepicker.p-invalid .p-inputtext:focus {
      border-color: var(--p-form-field-focus-border-color, var(--p-primary-color, #3b82f6)) !important;
      box-shadow: var(--p-form-field-focus-ring-shadow, 0 0 0 0.2rem rgba(59, 130, 246, 0.25)) !important;
    }
  }
}
