// Row-specific styling overrides and customizations
@use 'sass:math';
@use '../../styles/grid-system.scss';

:host {
  // Row flex container - horizontal layout by default (desktop)
  display: flex;
  flex-direction: row;
  flex-wrap: wrap;
  gap: var(--df-grid-gap);
  align-items: baseline; // Align items by text baseline
  width: 100%;

  // Desktop: children share available space equally unless col class specified
  ::ng-deep > *:not([class*='df-col-']) {
    flex: 1 1 0;
    min-width: 0; // Allow shrinking below content size
  }

  // Column span utilities for 12-column grid system (1-12)
  // Use ::ng-deep because child components have their own view encapsulation
  @for $i from 1 through 12 {
    ::ng-deep > .df-col-#{$i} {
      flex: 0 0 calc(#{math.percentage(math.div($i, 12))} - var(--df-grid-gap) * #{math.div((12 - $i), 12)});
      max-width: calc(#{math.percentage(math.div($i, 12))} - var(--df-grid-gap) * #{math.div((12 - $i), 12)});
    }
  }

  // Auto-size column - use natural content width
  ::ng-deep > .df-col-auto {
    flex: 0 0 auto;
    width: auto;
  }

  // Allow customization of gap for individual rows
  &.df-gap-custom {
    --df-grid-gap: var(--row-custom-gap, 1rem);
  }

  // Justify content options
  &.df-row-space-between {
    justify-content: space-between;

    ::ng-deep > * {
      flex: 0 0 auto !important; // Don't grow, use natural size
      width: auto !important; // Override any width: 100%
    }
  }

  // Opt-in: keep side-by-side on mobile
  &.df-row-mobile-keep-cols {
    @media (max-width: 768px) {
      flex-direction: row !important;
      flex-wrap: wrap !important;

      // Children without col class grow equally
      ::ng-deep > *:not([class*='df-col-']) {
        flex: 1 1 0 !important;
        width: auto !important;
        max-width: none !important;
      }

      // Children with col-auto use natural size
      ::ng-deep > [class*='df-col-'] {
        flex: 0 0 auto !important;
        width: auto !important;
      }
    }
  }
}

// Responsive behavior for rows - stack on tablet and below (768px)
@media (max-width: 768px) {
  :host:not(.df-row-mobile-keep-cols) {
    // Force single column on mobile/tablet for better UX
    flex-direction: column !important;
    flex-wrap: nowrap !important;
    align-items: flex-start !important; // Align children to start, natural size

    // Children use natural size on mobile
    ::ng-deep > * {
      flex: 0 0 auto !important;
      width: auto !important;
      max-width: 100% !important;
    }
  }
}
